from __future__ import division, print_function
import math
import numpy as np
from scipy import linalg
from matplotlib.pyplot import plot, subplot, legend, figure
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import axes3d
import example2sys as e2s


def optionPricingScript():
    N = 1000
    option = "call"
    r = 0.05
    T = 1
    K = 10.5
    L = 30
    integrator = "dopri5"
    integrator_options = {"nsteps" : 2000}

    sys = e2s.optionPricing(N=N, option=option,
                            r=r, T=T, K=K, L=L)

    sys.integrator = integrator
    sys.integrator_options = integrator_options

    timeSteps = list(np.linspace(0, T, 10))

    res = sys(timeSteps)

    fig = figure()

    ax = fig.add_subplot(111, projection='3d')
    N2 = int(1.5*K*N/L)
    X, Y, Z = [], [], []
    for i in range(len(timeSteps)):
        X.append([timeSteps[i] for _ in range(N2)])
        Y.append([j*L/N for j in range(N2)])
        Z.append(list(res[i])[:N2])

    ax.plot_surface(X, Y, Z)

def controllableHeatSystemPlot():
    X = [[0.0, 0.0, 0.0, 0.0, 0.0],
         [0.042646464646464648, 0.042646464646464648, 0.042646464646464648, 0.042646464646464648, 0.042646464646464648],
         [0.085292929292929295, 0.085292929292929295, 0.085292929292929295, 0.085292929292929295, 0.085292929292929295],
         [0.12793939393939394, 0.12793939393939394, 0.12793939393939394, 0.12793939393939394, 0.12793939393939394],
         [0.17058585858585859, 0.17058585858585859, 0.17058585858585859, 0.17058585858585859, 0.17058585858585859],
         [0.21323232323232325, 0.21323232323232325, 0.21323232323232325, 0.21323232323232325, 0.21323232323232325],
         [0.25587878787878787, 0.25587878787878787, 0.25587878787878787, 0.25587878787878787, 0.25587878787878787],
         [0.29852525252525253, 0.29852525252525253, 0.29852525252525253, 0.29852525252525253, 0.29852525252525253],
         [0.34117171717171718, 0.34117171717171718, 0.34117171717171718, 0.34117171717171718, 0.34117171717171718],
         [0.38381818181818184, 0.38381818181818184, 0.38381818181818184, 0.38381818181818184, 0.38381818181818184],
         [0.42646464646464649, 0.42646464646464649, 0.42646464646464649, 0.42646464646464649, 0.42646464646464649],
         [0.46911111111111115, 0.46911111111111115, 0.46911111111111115, 0.46911111111111115, 0.46911111111111115],
         [0.51175757575757574, 0.51175757575757574, 0.51175757575757574, 0.51175757575757574, 0.51175757575757574],
         [0.55440404040404045, 0.55440404040404045, 0.55440404040404045, 0.55440404040404045, 0.55440404040404045],
         [0.59705050505050505, 0.59705050505050505, 0.59705050505050505, 0.59705050505050505, 0.59705050505050505],
         [0.63969696969696976, 0.63969696969696976, 0.63969696969696976, 0.63969696969696976, 0.63969696969696976],
         [0.68234343434343436, 0.68234343434343436, 0.68234343434343436, 0.68234343434343436, 0.68234343434343436],
         [0.72498989898989896, 0.72498989898989896, 0.72498989898989896, 0.72498989898989896, 0.72498989898989896],
         [0.76763636363636367, 0.76763636363636367, 0.76763636363636367, 0.76763636363636367, 0.76763636363636367],
         [0.81028282828282827, 0.81028282828282827, 0.81028282828282827, 0.81028282828282827, 0.81028282828282827],
         [0.85292929292929298, 0.85292929292929298, 0.85292929292929298, 0.85292929292929298, 0.85292929292929298],
         [0.89557575757575758, 0.89557575757575758, 0.89557575757575758, 0.89557575757575758, 0.89557575757575758],
         [0.93822222222222229, 0.93822222222222229, 0.93822222222222229, 0.93822222222222229, 0.93822222222222229],
         [0.98086868686868689, 0.98086868686868689, 0.98086868686868689, 0.98086868686868689, 0.98086868686868689],
         [1.0235151515151515, 1.0235151515151515, 1.0235151515151515, 1.0235151515151515, 1.0235151515151515],
         [1.0661616161616161, 1.0661616161616161, 1.0661616161616161, 1.0661616161616161, 1.0661616161616161],
         [1.1088080808080809, 1.1088080808080809, 1.1088080808080809, 1.1088080808080809, 1.1088080808080809],
         [1.1514545454545455, 1.1514545454545455, 1.1514545454545455, 1.1514545454545455, 1.1514545454545455],
         [1.1941010101010101, 1.1941010101010101, 1.1941010101010101, 1.1941010101010101, 1.1941010101010101],
         [1.2367474747474747, 1.2367474747474747, 1.2367474747474747, 1.2367474747474747, 1.2367474747474747],
         [1.2793939393939395, 1.2793939393939395, 1.2793939393939395, 1.2793939393939395, 1.2793939393939395],
         [1.3220404040404041, 1.3220404040404041, 1.3220404040404041, 1.3220404040404041, 1.3220404040404041],
         [1.3646868686868687, 1.3646868686868687, 1.3646868686868687, 1.3646868686868687, 1.3646868686868687],
         [1.4073333333333333, 1.4073333333333333, 1.4073333333333333, 1.4073333333333333, 1.4073333333333333],
         [1.4499797979797979, 1.4499797979797979, 1.4499797979797979, 1.4499797979797979, 1.4499797979797979],
         [1.4926262626262627, 1.4926262626262627, 1.4926262626262627, 1.4926262626262627, 1.4926262626262627],
         [1.5352727272727273, 1.5352727272727273, 1.5352727272727273, 1.5352727272727273, 1.5352727272727273],
         [1.5779191919191919, 1.5779191919191919, 1.5779191919191919, 1.5779191919191919, 1.5779191919191919],
         [1.6205656565656565, 1.6205656565656565, 1.6205656565656565, 1.6205656565656565, 1.6205656565656565],
         [1.6632121212121214, 1.6632121212121214, 1.6632121212121214, 1.6632121212121214, 1.6632121212121214],
         [1.705858585858586, 1.705858585858586, 1.705858585858586, 1.705858585858586, 1.705858585858586],
         [1.7485050505050506, 1.7485050505050506, 1.7485050505050506, 1.7485050505050506, 1.7485050505050506],
         [1.7911515151515152, 1.7911515151515152, 1.7911515151515152, 1.7911515151515152, 1.7911515151515152],
         [1.8337979797979798, 1.8337979797979798, 1.8337979797979798, 1.8337979797979798, 1.8337979797979798],
         [1.8764444444444446, 1.8764444444444446, 1.8764444444444446, 1.8764444444444446, 1.8764444444444446],
         [1.9190909090909092, 1.9190909090909092, 1.9190909090909092, 1.9190909090909092, 1.9190909090909092],
         [1.9617373737373738, 1.9617373737373738, 1.9617373737373738, 1.9617373737373738, 1.9617373737373738],
         [2.0043838383838386, 2.0043838383838386, 2.0043838383838386, 2.0043838383838386, 2.0043838383838386],
         [2.047030303030303, 2.047030303030303, 2.047030303030303, 2.047030303030303, 2.047030303030303],
         [2.0896767676767678, 2.0896767676767678, 2.0896767676767678, 2.0896767676767678, 2.0896767676767678],
         [2.1323232323232322, 2.1323232323232322, 2.1323232323232322, 2.1323232323232322, 2.1323232323232322],
         [2.174969696969697, 2.174969696969697, 2.174969696969697, 2.174969696969697, 2.174969696969697],
         [2.2176161616161618, 2.2176161616161618, 2.2176161616161618, 2.2176161616161618, 2.2176161616161618],
         [2.2602626262626262, 2.2602626262626262, 2.2602626262626262, 2.2602626262626262, 2.2602626262626262],
         [2.302909090909091, 2.302909090909091, 2.302909090909091, 2.302909090909091, 2.302909090909091],
         [2.3455555555555558, 2.3455555555555558, 2.3455555555555558, 2.3455555555555558, 2.3455555555555558],
         [2.3882020202020202, 2.3882020202020202, 2.3882020202020202, 2.3882020202020202, 2.3882020202020202],
         [2.430848484848485, 2.430848484848485, 2.430848484848485, 2.430848484848485, 2.430848484848485],
         [2.4734949494949494, 2.4734949494949494, 2.4734949494949494, 2.4734949494949494, 2.4734949494949494],
         [2.5161414141414142, 2.5161414141414142, 2.5161414141414142, 2.5161414141414142, 2.5161414141414142],
         [2.5587878787878791, 2.5587878787878791, 2.5587878787878791, 2.5587878787878791, 2.5587878787878791],
         [2.6014343434343434, 2.6014343434343434, 2.6014343434343434, 2.6014343434343434, 2.6014343434343434],
         [2.6440808080808083, 2.6440808080808083, 2.6440808080808083, 2.6440808080808083, 2.6440808080808083],
         [2.6867272727272726, 2.6867272727272726, 2.6867272727272726, 2.6867272727272726, 2.6867272727272726],
         [2.7293737373737375, 2.7293737373737375, 2.7293737373737375, 2.7293737373737375, 2.7293737373737375],
         [2.7720202020202023, 2.7720202020202023, 2.7720202020202023, 2.7720202020202023, 2.7720202020202023],
         [2.8146666666666667, 2.8146666666666667, 2.8146666666666667, 2.8146666666666667, 2.8146666666666667],
         [2.8573131313131315, 2.8573131313131315, 2.8573131313131315, 2.8573131313131315, 2.8573131313131315],
         [2.8999595959595958, 2.8999595959595958, 2.8999595959595958, 2.8999595959595958, 2.8999595959595958],
         [2.9426060606060607, 2.9426060606060607, 2.9426060606060607, 2.9426060606060607, 2.9426060606060607],
         [2.9852525252525255, 2.9852525252525255, 2.9852525252525255, 2.9852525252525255, 2.9852525252525255],
         [3.0278989898989899, 3.0278989898989899, 3.0278989898989899, 3.0278989898989899, 3.0278989898989899],
         [3.0705454545454547, 3.0705454545454547, 3.0705454545454547, 3.0705454545454547, 3.0705454545454547],
         [3.1131919191919191, 3.1131919191919191, 3.1131919191919191, 3.1131919191919191, 3.1131919191919191],
         [3.1558383838383839, 3.1558383838383839, 3.1558383838383839, 3.1558383838383839, 3.1558383838383839],
         [3.1984848484848487, 3.1984848484848487, 3.1984848484848487, 3.1984848484848487, 3.1984848484848487],
         [3.2411313131313131, 3.2411313131313131, 3.2411313131313131, 3.2411313131313131, 3.2411313131313131],
         [3.2837777777777779, 3.2837777777777779, 3.2837777777777779, 3.2837777777777779, 3.2837777777777779],
         [3.3264242424242427, 3.3264242424242427, 3.3264242424242427, 3.3264242424242427, 3.3264242424242427],
         [3.3690707070707071, 3.3690707070707071, 3.3690707070707071, 3.3690707070707071, 3.3690707070707071],
         [3.4117171717171719, 3.4117171717171719, 3.4117171717171719, 3.4117171717171719, 3.4117171717171719],
         [3.4543636363636363, 3.4543636363636363, 3.4543636363636363, 3.4543636363636363, 3.4543636363636363],
         [3.4970101010101011, 3.4970101010101011, 3.4970101010101011, 3.4970101010101011, 3.4970101010101011],
         [3.5396565656565659, 3.5396565656565659, 3.5396565656565659, 3.5396565656565659, 3.5396565656565659],
         [3.5823030303030303, 3.5823030303030303, 3.5823030303030303, 3.5823030303030303, 3.5823030303030303],
         [3.6249494949494951, 3.6249494949494951, 3.6249494949494951, 3.6249494949494951, 3.6249494949494951],
         [3.6675959595959595, 3.6675959595959595, 3.6675959595959595, 3.6675959595959595, 3.6675959595959595],
         [3.7102424242424243, 3.7102424242424243, 3.7102424242424243, 3.7102424242424243, 3.7102424242424243],
         [3.7528888888888892, 3.7528888888888892, 3.7528888888888892, 3.7528888888888892, 3.7528888888888892],
         [3.7955353535353535, 3.7955353535353535, 3.7955353535353535, 3.7955353535353535, 3.7955353535353535],
         [3.8381818181818184, 3.8381818181818184, 3.8381818181818184, 3.8381818181818184, 3.8381818181818184],
         [3.8808282828282827, 3.8808282828282827, 3.8808282828282827, 3.8808282828282827, 3.8808282828282827],
         [3.9234747474747476, 3.9234747474747476, 3.9234747474747476, 3.9234747474747476, 3.9234747474747476],
         [3.9661212121212124, 3.9661212121212124, 3.9661212121212124, 3.9661212121212124, 3.9661212121212124],
         [4.0087676767676772, 4.0087676767676772, 4.0087676767676772, 4.0087676767676772, 4.0087676767676772],
         [4.0514141414141411, 4.0514141414141411, 4.0514141414141411, 4.0514141414141411, 4.0514141414141411],
         [4.094060606060606, 4.094060606060606, 4.094060606060606, 4.094060606060606, 4.094060606060606],
         [4.1367070707070708, 4.1367070707070708, 4.1367070707070708, 4.1367070707070708, 4.1367070707070708],
         [4.1793535353535356, 4.1793535353535356, 4.1793535353535356, 4.1793535353535356, 4.1793535353535356],
         [4.2220000000000004, 4.2220000000000004, 4.2220000000000004, 4.2220000000000004, 4.2220000000000004]]
    Y = [[0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0],
         [0.0, 0.25, 0.5, 0.75, 1.0]]
    Z = [[0.0, 0.0, 0.0, 0.0, 0.0],
         [0.0, 0.0015430421821912409, 0.010984840303416558, 0.0020332564133142194, 0.0],
         [0.0, 0.0077968031683554803, 0.031022894076792776, 0.0095067953629537523, 0.0],
         [0.0, 0.017571100997872374, 0.056329350774577791, 0.020894697941237512, 0.0],
         [0.0, 0.029644523981234506, 0.085018102982247934, 0.034833660319807953, 0.0],
         [0.0, 0.043195094325510421, 0.11584040207148256, 0.050409700797255916, 0.0],
         [0.0, 0.057672581359243587, 0.14795469568571279, 0.067010746357283935, 0.0],
         [0.0, 0.07270548263204496, 0.18078672764167972, 0.084223268287766273, 0.0],
         [0.0, 0.088039792052027444, 0.21393804243083081, 0.10176421384888192, 0.0],
         [0.0, 0.10349876380927669, 0.24712588654189302, 0.11943636499456661, 0.0],
         [0.0, 0.11895653221336827, 0.28014381808580069, 0.13709901474700226, 0.0],
         [0.0, 0.13432079015019452, 0.31283585331932157, 0.1546487476266834, 0.0],
         [0.0, 0.14952144059037062, 0.34507953948481418, 0.17200682793649588, 0.0],
         [0.0, 0.16450315589995371, 0.37677486699430063, 0.18911094315514743, 0.0],
         [0.0, 0.17922051143527856, 0.40783702823439999, 0.20590979768631218, 0.0],
         [0.0, 0.19363480456208157, 0.43819169441897449, 0.22235958331588901, 0.0],
         [0.0, 0.20771198277894445, 0.46777194921102894, 0.23842167868156311, 0.0],
         [0.0, 0.22142129827777562, 0.49651630713174599, 0.25406115700727655, 0.0],
         [0.0, 0.23473443992589826, 0.52436744457774742, 0.26924582319099677, 0.0],
         [0.0, 0.24762497783822562, 0.55127139704663042, 0.28394559846777639, 0.0],
         [0.0, 0.26006801296359128, 0.57717706175773409, 0.29813213246815362, 0.0],
         [0.0, 0.27203996063490388, 0.60203589943386715, 0.31177856414052302, 0.0],
         [0.0, 0.28351842160372109, 0.6258017657374888, 0.32485937970945039, 0.0],
         [0.0, 0.29448210990189883, 0.64843082649974049, 0.33735033372936629, 0.0],
         [0.0, 0.30491081743362214, 0.66988152666691536, 0.34922841085301332, 0.0],
         [0.0, 0.31478540204695837, 0.69011459312122514, 0.36047181362743042, 0.0],
         [0.0, 0.32408779037917307, 0.7090930583279289, 0.37105996663018903, 0.0],
         [0.0, 0.33280098973038819, 0.72678229618706036, 0.3809735305719873, 0.0],
         [0.0, 0.34090910517899503, 0.74315006439792497, 0.39019442215392058, 0.0],
         [0.0, 0.34839735943285438, 0.75816654956068796, 0.39870583689695943, 0.0],
         [0.0, 0.35525211375601395, 0.77180441250577947, 0.40649227309736202, 0.0],
         [0.0, 0.36146088886589928, 0.78403883217408843, 0.41353955567970335, 0.0],
         [0.0, 0.36701238506234735, 0.79484754692107229, 0.4198348591260308, 0.0],
         [0.0, 0.37189650109177119, 0.80421089248205735, 0.42536672892845612, 0.0],
         [0.0, 0.37610435141009496, 0.81211183607827331, 0.43012510119049502, 0.0],
         [0.0, 0.37962828161446155, 0.81853600630478551, 0.43410132012134051, 0.0],
         [0.0, 0.38246188188553465, 0.82347171855153034, 0.43728815324631459, 0.0],
         [0.0, 0.384599998330243, 0.82690999578312274, 0.43967980421096403, 0.0],
         [0.0, 0.38603874214821143, 0.8288445845557818, 0.44127192309301566, 0.0],
         [0.0, 0.38677549656824151, 0.82927196618698118, 0.44206161416253364, 0.0],
         [0.0, 0.3868089215149445, 0.82819136301673379, 0.44204744105263316, 0.0],
         [0.0, 0.3861389559948239, 0.82560473974593651, 0.441229429298447, 0.0],
         [0.0, 0.38476681816655461, 0.82151679980284376, 0.43960906625087359, 0.0],
         [0.0, 0.38269500309466992, 0.81593497674358417, 0.43718929835072184, 0.0],
         [0.0, 0.37992727820182209, 0.80886942071885992, 0.43397452574590184, 0.0],
         [0.0, 0.37646867640443799, 0.80033297999623865, 0.42997059428092405, 0.0],
         [0.0, 0.37232548695489098, 0.79034117758772138, 0.42518478485712707, 0.0],
         [0.0, 0.36750524399946177, 0.7789121830139476, 0.41962580018835527, 0.0],
         [0.0, 0.36201671287520065, 0.76606677925987521, 0.41330374897173755, 0.0],
         [0.0, 0.35586987416843641, 0.75182832497876328, 0.40623012750354842, 0.0],
         [0.0, 0.34907590556441043, 0.73622271201392342, 0.39841779877223438, 0.0],
         [0.0, 0.34164716152033325, 0.71927831831442013, 0.38988096906688058, 0.0],
         [0.0, 0.3335971507989488, 0.70102595633053044, 0.38063516214316911, 0.0],
         [0.0, 0.32494051190318696, 0.68149881698238857, 0.37069719099389575, 0.0],
         [0.0, 0.3156929864566223, 0.66073240930377652, 0.36008512727516379, 0.0],
         [0.0, 0.30587139057801288, 0.63876449587062045, 0.34881826844390262, 0.0],
         [0.0, 0.29549358430201472, 0.61563502413167159, 0.33691710266636998, 0.0],
         [0.0, 0.28457843910160513, 0.5913860537661354, 0.32440327156147158, 0.0],
         [0.0, 0.27314580357130036, 0.56606168020038372, 0.31129953084660689, 0.0],
         [0.0, 0.26121646733355131, 0.53970795442280095, 0.29762970895759955, 0.0],
         [0.0, 0.24881212323390947, 0.51237279924251911, 0.28341866371798785, 0.0],
         [0.0, 0.2359553278937834, 0.48410592214442127, 0.26869223713639512, 0.0],
         [0.0, 0.22266946069243612, 0.45495872489876998, 0.25347720841425392, 0.0],
         [0.0, 0.20897868125286265, 0.4249842100898979, 0.23780124524927942, 0.0],
         [0.0, 0.19490788550882757, 0.39423688473389085, 0.22169285352327664, 0.0],
         [0.0, 0.18048266043297559, 0.3627726611605665, 0.20518132546573875, 0.0],
         [0.0, 0.16572923750832091, 0.33064875533995636, 0.18829668638753025, 0.0],
         [0.0, 0.15067444502773722, 0.29792358283819992, 0.17106964008149153, 0.0],
         [0.0, 0.13534565930818188, 0.26465665259203697, 0.15353151298925896, 0.0],
         [0.0, 0.11977075490838322, 0.230908458695081, 0.13571419723581657, 0.0],
         [0.0, 0.1039780539405448, 0.19674037039269046, 0.11765009263534411, 0.0],
         [0.0, 0.087996274568271249, 0.16221452048551094, 0.099372047773770608, 0.0],
         [0.0, 0.07185447878459332, 0.12739369234491038, 0.080913300274946837, 0.0],
         [0.0, 0.055582019565875364, 0.092341205746871796, 0.062307416358138933, 0.0],
         [0.0, 0.039208487502702991, 0.057120801738880921, 0.043588229791245978, 0.0],
         [0.0, 0.022763657064014849, 0.021796526833578658, 0.024789780285256892, 0.0],
         [0.0, 0.0062774318518430709, -0.013567384422752614, 0.0059462522661637473, 0.0],
         [0.0, -0.010220215191933337, -0.04890663319809832, -0.012908081383800884, 0.0],
         [0.0, -0.02669927968060793, -0.084156952846915462, -0.031738939613953576, 0.0],
         [0.0, -0.043129799752941407, -0.11925424693220481, -0.050512074899474908, 0.0],
         [0.0, -0.059481879250624203, -0.15413466706163412, -0.069193369367463953, 0.0],
         [0.0, -0.075725804199668997, -0.18873481636687092, -0.087748828393692913, 0.0],
         [0.0, -0.091832018127376069, -0.22299175029602458, -0.10614472960964851, 0.0],
         [0.0, -0.10777124506704452, -0.25684319255271576, -0.12434760743161492, 0.0],
         [0.0, -0.12351449346645146, -0.29022757594174492, -0.14232436861789335, 0.0],
         [0.0, -0.13903313884811175, -0.32308419831745361, -0.16004231924217194, 0.0],
         [0.0, -0.15429895935836982, -0.35535330869787463, -0.17746924244904311, 0.0],
         [0.0, -0.16928419603115316, -0.38697622908127116, -0.19457344711834335, 0.0],
         [0.0, -0.18396159844962998, -0.41789545405677297, -0.21132383083627407, 0.0],
         [0.0, -0.19830447686780406, -0.44805475915804754, -0.22768993360463352, 0.0],
         [0.0, -0.21228674938348249, -0.47739930109904799, -0.24364199474027248, 0.0],
         [0.0, -0.22588299008318258, -0.50587571855951297, -0.25915100619854875, 0.0],
         [0.0, -0.23906847490250127, -0.5334322286663381, -0.27418876573917694, 0.0],
         [0.0, -0.25181922678107144, -0.56001872144634102, -0.28872792799346603, 0.0],
         [0.0, -0.26411205916198383, -0.58558685079873019, -0.30274205430303469, 0.0],
         [0.0, -0.27592461820777736, -0.61009012248729777, -0.31620566073881917, 0.0],
         [0.0, -0.28723542342261288, -0.63348397864773032, -0.32909426447222562, 0.0],
         [0.0, -0.29802390672727019, -0.65572587883413891, -0.34138442828040072, 0.0],
         [0.0, -0.30827044985396185, -0.67677537736604243, -0.35305380317343249, 0.0],
         [0.0, -0.31795642002470548, -0.69659419688197033, -0.36408116903074589, 0.0]]

    fig = figure()
    ax = fig.gca(projection='3d')

    ax.plot_surface(X[:15], Y[:15], Z[:15], rstride=1, cstride=1)

    plt.show()

controllableHeatSystemPlot()
